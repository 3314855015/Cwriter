<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>墨夜文书 - 忘记密码</title>
    <script src="https://unpkg.byted-static.com/coze/space_ppt_lib/1.0.3-alpha.12/lib/tailwindcss.js"></script>
    <script src="https://unpkg.byted-static.com/fortawesome/fontawesome-free/6.7.2/js/all.min.js" data-auto-replace-svg="nest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B35',
                        secondary: '#4ECDC4',
                        tertiary: '#45B7D1',
                        success: '#96CEB4',
                        danger: '#FFEAA7',
                        warning: '#FD79A8',
                        dark: {
                            100: '#1A1A1A',
                            200: '#2D2D2D',
                            300: '#404040',
                            400: '#525252',
                            500: '#737373'
                        },
                        text: {
                            primary: '#FFFFFF',
                            secondary: '#B3B3B3',
                            tertiary: '#808080'
                        }
                    },
                    fontFamily: {
                        'sans': ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif']
                    },
                    boxShadow: {
                        'card': '0 4px 12px rgba(0, 0, 0, 0.3)',
                        'fab': '0 6px 20px rgba(255, 107, 53, 0.4)'
                    }
                }
            }
        }
    </script>
    <style>
        .safe-top {
            padding-top: env(safe-area-inset-top);
        }
        .safe-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .glass {
            background: rgba(45, 45, 45, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .form-input {
            background: rgba(64, 64, 64, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #FF6B35;
            background: rgba(64, 64, 64, 0.7);
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #FF6B35 0%, #FF8A65 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.4);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: rgba(64, 64, 64, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: rgba(80, 80, 80, 0.5);
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .error-message {
            color: #FD79A8;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        
        .success-message {
            color: #96CEB4;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        
        .loading-spinner {
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 2px solid #FFFFFF;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .back-button {
            transition: all 0.2s ease;
        }
        
        .back-button:hover {
            background-color: rgba(64, 64, 64, 0.5);
        }
    </style>
</head>
<body class="bg-dark-100 text-text-primary font-sans min-h-screen">
    <!-- 状态栏 -->
    <div id="status-bar" class="bg-dark-100 text-text-primary text-sm flex justify-between items-center px-4 py-1 safe-top">
        <div class="flex items-center space-x-1">
            <span>9:41</span>
        </div>
        <div class="flex items-center space-x-1">
            <i class="fas fa-signal text-xs"></i>
            <i class="fas fa-wifi text-xs"></i>
            <i class="fas fa-battery-three-quarters text-xs"></i>
        </div>
    </div>

    <!-- 主容器 -->
    <div id="main-container" class="min-h-screen bg-dark-100">
        <!-- 顶部导航栏 -->
        <header id="top-header" class="glass px-4 py-4 border-b border-dark-300">
            <div class="flex items-center justify-between">
                <button id="back-button" class="back-button w-10 h-10 rounded-full flex items-center justify-center">
                    <i class="fas fa-arrow-left text-text-primary text-lg"></i>
                </button>
                <h1 id="page-title" class="text-lg font-semibold text-text-primary">忘记密码</h1>
                <div class="w-10"></div> <!-- 占位元素保持标题居中 -->
            </div>
        </header>

        <!-- 主要内容区域 -->
        <main id="main-content" class="px-6 py-8">
            <!-- 页面说明 -->
            <div id="page-description" class="text-center mb-8">
                <div id="icon-container" class="w-16 h-16 bg-primary/20 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-key text-primary text-2xl"></i>
                </div>
                <h2 id="description-title" class="text-xl font-semibold text-text-primary mb-2">重置密码</h2>
                <p id="description-text" class="text-text-secondary text-sm">请输入您的手机号或邮箱，我们将发送验证码帮助您重置密码</p>
            </div>

            <!-- 重置密码表单 -->
            <form id="reset-password-form" class="space-y-6">
                <!-- 手机号/邮箱输入 -->
                <div id="contact-input-group" class="space-y-2">
                    <label for="contact-input" class="block text-sm font-medium text-text-primary">手机号/邮箱</label>
                    <input 
                        type="text" 
                        id="contact-input" 
                        name="contact" 
                        class="form-input w-full px-4 py-3 rounded-lg text-text-primary placeholder-text-tertiary"
                        placeholder="请输入手机号或邮箱"
                        required
                    >
                    <div id="contact-error" class="error-message hidden"></div>
                </div>

                <!-- 验证码输入 -->
                <div id="verification-input-group" class="space-y-2">
                    <label for="verification-input" class="block text-sm font-medium text-text-primary">验证码</label>
                    <div class="flex space-x-3">
                        <input 
                            type="text" 
                            id="verification-input" 
                            name="verification" 
                            class="form-input flex-1 px-4 py-3 rounded-lg text-text-primary placeholder-text-tertiary"
                            placeholder="请输入验证码"
                            maxlength="6"
                            required
                        >
                        <button 
                            type="button" 
                            id="get-code-button" 
                            class="btn-secondary px-4 py-3 rounded-lg text-text-primary font-medium whitespace-nowrap"
                        >
                            获取验证码
                        </button>
                    </div>
                    <div id="verification-error" class="error-message hidden"></div>
                </div>

                <!-- 新密码输入 -->
                <div id="new-password-input-group" class="space-y-2">
                    <label for="new-password-input" class="block text-sm font-medium text-text-primary">新密码</label>
                    <div class="relative">
                        <input 
                            type="password" 
                            id="new-password-input" 
                            name="new-password" 
                            class="form-input w-full px-4 py-3 pr-12 rounded-lg text-text-primary placeholder-text-tertiary"
                            placeholder="请输入新密码（至少6位）"
                            minlength="6"
                            required
                        >
                        <button 
                            type="button" 
                            id="toggle-new-password" 
                            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-secondary"
                        >
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div id="new-password-error" class="error-message hidden"></div>
                </div>

                <!-- 确认新密码输入 -->
                <div id="confirm-password-input-group" class="space-y-2">
                    <label for="confirm-password-input" class="block text-sm font-medium text-text-primary">确认新密码</label>
                    <div class="relative">
                        <input 
                            type="password" 
                            id="confirm-password-input" 
                            name="confirm-password" 
                            class="form-input w-full px-4 py-3 pr-12 rounded-lg text-text-primary placeholder-text-tertiary"
                            placeholder="请再次输入新密码"
                            minlength="6"
                            required
                        >
                        <button 
                            type="button" 
                            id="toggle-confirm-password" 
                            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-secondary"
                        >
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div id="confirm-password-error" class="error-message hidden"></div>
                </div>

                <!-- 重置密码按钮 -->
                <button 
                    type="submit" 
                    id="reset-password-button" 
                    class="btn-primary w-full py-3 rounded-lg text-white font-semibold text-lg"
                >
                    <span id="reset-button-text">重置密码</span>
                    <div id="reset-button-loading" class="loading-spinner mx-auto hidden"></div>
                </button>

                <!-- 成功提示 -->
                <div id="success-message" class="success-message text-center hidden">
                    <i class="fas fa-check-circle mr-2"></i>
                    密码重置成功，正在跳转到登录页面...
                </div>
            </form>

            <!-- 返回登录链接 -->
            <div id="back-to-login" class="text-center mt-8">
                <button id="back-to-login-button" class="text-primary hover:text-primary/80 font-medium transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>
                    返回登录
                </button>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 获取表单元素
            const resetForm = document.querySelector('#reset-password-form');
            const contactInput = document.querySelector('#contact-input');
            const verificationInput = document.querySelector('#verification-input');
            const newPasswordInput = document.querySelector('#new-password-input');
            const confirmPasswordInput = document.querySelector('#confirm-password-input');
            const getCodeButton = document.querySelector('#get-code-button');
            const resetButton = document.querySelector('#reset-password-button');
            const backButton = document.querySelector('#back-button');
            const backToLoginButton = document.querySelector('#back-to-login-button');
            const toggleNewPassword = document.querySelector('#toggle-new-password');
            const toggleConfirmPassword = document.querySelector('#toggle-confirm-password');

            // 验证码倒计时状态
            let countdownTimer = null;
            let countdownSeconds = 0;

            // 返回按钮点击事件
            backButton.addEventListener('click', function() {
                window.location.href = 'P-LOGIN.html';
            });

            // 返回登录按钮点击事件
            backToLoginButton.addEventListener('click', function() {
                window.location.href = 'P-LOGIN.html';
            });

            // 密码显示/隐藏切换
            toggleNewPassword.addEventListener('click', function() {
                const type = newPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                newPasswordInput.setAttribute('type', type);
                const icon = this.querySelector('i');
                icon.classList.toggle('fa-eye');
                icon.classList.toggle('fa-eye-slash');
            });

            toggleConfirmPassword.addEventListener('click', function() {
                const type = confirmPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                confirmPasswordInput.setAttribute('type', type);
                const icon = this.querySelector('i');
                icon.classList.toggle('fa-eye');
                icon.classList.toggle('fa-eye-slash');
            });

            // 验证手机号或邮箱格式
            function validateContact(contact) {
                const phoneRegex = /^1[3-9]\d{9}$/;
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return phoneRegex.test(contact) || emailRegex.test(contact);
            }

            // 显示错误信息
            function showError(inputId, message) {
                const errorElement = document.querySelector(`#${inputId}-error`);
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.classList.remove('hidden');
                }
            }

            // 隐藏错误信息
            function hideError(inputId) {
                const errorElement = document.querySelector(`#${inputId}-error`);
                if (errorElement) {
                    errorElement.classList.add('hidden');
                }
            }

            // 开始验证码倒计时
            function startCountdown() {
                countdownSeconds = 60;
                getCodeButton.disabled = true;
                
                countdownTimer = setInterval(function() {
                    getCodeButton.textContent = `${countdownSeconds}秒后重试`;
                    countdownSeconds--;
                    
                    if (countdownSeconds < 0) {
                        clearInterval(countdownTimer);
                        getCodeButton.disabled = false;
                        getCodeButton.textContent = '获取验证码';
                    }
                }, 1000);
            }

            // 获取验证码按钮点击事件
            getCodeButton.addEventListener('click', function() {
                const contact = contactInput.value.trim();
                
                // 验证联系方式
                if (!contact) {
                    showError('contact', '请输入手机号或邮箱');
                    return;
                }
                
                if (!validateContact(contact)) {
                    showError('contact', '请输入正确的手机号或邮箱格式');
                    return;
                }
                
                hideError('contact');
                
                // 模拟发送验证码
                console.log('发送验证码到:', contact);
                startCountdown();
                
                // 显示成功提示（可选）
                const successMsg = document.createElement('div');
                successMsg.className = 'success-message';
                successMsg.innerHTML = '<i class="fas fa-check-circle mr-2"></i>验证码已发送';
                contactInput.parentNode.appendChild(successMsg);
                
                setTimeout(function() {
                    successMsg.remove();
                }, 3000);
            });

            // 表单提交事件
            resetForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // 获取表单数据
                const contact = contactInput.value.trim();
                const verification = verificationInput.value.trim();
                const newPassword = newPasswordInput.value;
                const confirmPassword = confirmPasswordInput.value;
                
                // 验证所有字段
                let hasError = false;
                
                // 验证联系方式
                if (!contact) {
                    showError('contact', '请输入手机号或邮箱');
                    hasError = true;
                } else if (!validateContact(contact)) {
                    showError('contact', '请输入正确的手机号或邮箱格式');
                    hasError = true;
                } else {
                    hideError('contact');
                }
                
                // 验证验证码
                if (!verification) {
                    showError('verification', '请输入验证码');
                    hasError = true;
                } else if (verification.length !== 6) {
                    showError('verification', '验证码应为6位数字');
                    hasError = true;
                } else {
                    hideError('verification');
                }
                
                // 验证新密码
                if (!newPassword) {
                    showError('new-password', '请输入新密码');
                    hasError = true;
                } else if (newPassword.length < 6) {
                    showError('new-password', '密码至少需要6位字符');
                    hasError = true;
                } else {
                    hideError('new-password');
                }
                
                // 验证确认密码
                if (!confirmPassword) {
                    showError('confirm-password', '请确认新密码');
                    hasError = true;
                } else if (newPassword !== confirmPassword) {
                    showError('confirm-password', '两次输入的密码不一致');
                    hasError = true;
                } else {
                    hideError('confirm-password');
                }
                
                if (hasError) {
                    return;
                }
                
                // 显示加载状态
                resetButton.disabled = true;
                document.querySelector('#reset-button-text').classList.add('hidden');
                document.querySelector('#reset-button-loading').classList.remove('hidden');
                
                // 模拟重置密码请求
                setTimeout(function() {
                    console.log('重置密码请求:', {
                        contact: contact,
                        verification: verification,
                        newPassword: newPassword
                    });
                    
                    // 显示成功信息
                    document.querySelector('#success-message').classList.remove('hidden');
                    
                    // 3秒后跳转到登录页
                    setTimeout(function() {
                        window.location.href = 'P-LOGIN.html';
                    }, 3000);
                    
                }, 2000);
            });

            // 实时验证
            contactInput.addEventListener('input', function() {
                if (this.value.trim()) {
                    hideError('contact');
                }
            });

            verificationInput.addEventListener('input', function() {
                if (this.value.trim()) {
                    hideError('verification');
                }
            });

            newPasswordInput.addEventListener('input', function() {
                if (this.value) {
                    hideError('new-password');
                }
            });

            confirmPasswordInput.addEventListener('input', function() {
                if (this.value) {
                    hideError('confirm-password');
                }
            });
        });
    </script>
</body>
</html>